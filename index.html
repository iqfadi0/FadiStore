<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Quota Packages</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#0f0f0f;color:#fff}
.container{max-width:1100px;margin:auto;padding:20px}
.hidden{display:none}
input,button{padding:10px;margin:5px;width:100%;border-radius:6px;border:none}
button{background:#3b82f6;color:#fff;cursor:pointer}
.card{background:#1c1c1c;padding:15px;border-radius:10px;margin:10px 0}
.admin{background:#111;border:1px solid #333}
.package{border:1px solid #333}
</style>
</head>
<body>

<div class="container">

<h1>Quota Packages</h1>

<!-- LOGIN -->
<div id="login" class="card">
<h2>تسجيل الدخول</h2>
<input id="loginPhone" placeholder="رقم الهاتف">
<input id="loginPass" type="password" placeholder="كلمة المرور">
<button onclick="login()">دخول</button>
<p id="loginMsg"></p>
</div>

<!-- ADMIN -->
<div id="admin" class="hidden admin card">
<h2>لوحة الأدمن</h2>

<h3>إضافة زبون</h3>
<input id="newPhone" placeholder="رقم الهاتف">
<input id="newPass" placeholder="كلمة المرور">
<button onclick="addUser()">إضافة زبون</button>

<h3>إضافة رصيد</h3>
<input id="chargePhone" placeholder="رقم الهاتف">
<input id="chargeAmount" placeholder="المبلغ">
<button onclick="charge()">شحن</button>

<h3>إضافة باكج</h3>
<input id="pkgName" placeholder="اسم الباكج">
<input id="pkgPrice" placeholder="السعر">
<button onclick="addPackage()">إضافة</button>
</div>

<!-- USER -->
<div id="user" class="hidden card">
<h2>لوحة الزبون</h2>
<p>الرصيد: <span id="balance"></span> LBP</p>
<div id="packages"></div>
</div>

</div>

<script>
const ADMIN_USER="admin";
const ADMIN_PASS="admin123";

let users = JSON.parse(localStorage.getItem("users")||"{}");
let packages = JSON.parse(localStorage.getItem("packages")||"[]");
let currentUser=null;

function save(){
 localStorage.setItem("users",JSON.stringify(users));
 localStorage.setItem("packages",JSON.stringify(packages));
}

function login(){
 let p=loginPhone.value;
 let pass=loginPass.value;

 if(p===ADMIN_USER && pass===ADMIN_PASS){
  login.classList.add("hidden");
  admin.classList.remove("hidden");
  return;
 }

 if(users[p] && users[p].pass===pass){
  currentUser=p;
  login.classList.add("hidden");
  user.classList.remove("hidden");
  renderUser();
 }else{
  loginMsg.innerText="بيانات خاطئة";
 }
}

function addUser(){
 users[newPhone.value]={pass:newPass.value,balance:0};
 save(); alert("تمت الإضافة");
}

function charge(){
 users[chargePhone.value].balance += Number(chargeAmount.value);
 save(); alert("تم الشحن");
}

function addPackage(){
 packages.push({name:pkgName.value,price:Number(pkgPrice.value)});
 save(); alert("تمت إضافة الباكج");
}

function renderUser(){
 balance.innerText=users[currentUser].balance;
 packagesDiv=packages.map((p,i)=>`
 <div class="card package">
 <b>${p.name}</b> - ${p.price} LBP
 <input placeholder="رقم الهاتف">
 <button onclick="buy(${i})">اشتراك</button>
 </div>`).join("");
 document.getElementById("packages").innerHTML=packagesDiv;
}

function buy(i){
 let p=packages[i];
 if(users[currentUser].balance>=p.price){
  users[currentUser].balance-=p.price;
  save(); renderUser();
  alert("تم الاشتراك");
 }else alert("رصيد غير كافي");
}
</script>

</body>
</html>
